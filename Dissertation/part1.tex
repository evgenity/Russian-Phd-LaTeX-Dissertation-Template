\chapter{Применение методов машинного обучения к задачам управления инфраструктурой} \label{chapt1}

\section{Введение}

Теория обучения машин (machine learning, машинное обучение) находится на стыке прикладной статистики, численных методов оптимизации, дискретного анализа, и за последние 50 лет оформилась в самостоятельную математическую дисциплину. Методы машинного обучения составляют основу ещё более молодой дисциплины — интеллектуального анализа данных (data mining) \cite{воронцов2009машинное, marsland2015machineconway2012machine}.

\section{Индустриальные задачи в контексте машинного обучения} \label{sect1_1}
\begin{subsection}{Анализ состояния индустрии}
\todo{По нашим оценкам, приоритетными областями в российской экономике для внедрения технологий беспроводной связи и интернета вещей на горизонте 5-10 лет будут являться:}
\todo{телекоммуникации: обеспечение большей доступности широкополосной мобильной связи; масштабное развёртывание сенсорных сетей для всех отраслей экономики и массовых сетей обмена трафиком между устройствами (massive machine type communications);} \todo{сверхнадежные сети обмена данными реального времени (ultra-reliable low latency); связь в реальном времени в районах природных катастроф; виртуализация функций беспроводных сетей; предоставление услуг позиционирования объектов на открытых пространствах и внутри помещений; дополнительные сервисы операторов связи, основанные на обработке больших массивов накопленных данных;}
\todo{электроэнергетика: повышение надежности энергетической системы; сокращение затрат на ремонт и эксплуатацию, сокращение потерь; оптимизация работы энергосистемы за счет использования фактических, а не нормативных параметров, а также использования технологий аналитики больших массивов данных; создание новых рынков в электроэнергетике (интеграция различных источников энергии с нестабильным производством) и возможность их автоматического использования; возможность введения конкурентного розничного рынка электроэнергии;}
\todo{здравоохранение: системы удаленного мониторинга медицинских показателей пациентов в режиме реального времени; индивидуальный интеллектуальный анализ состояния пациента на основе постоянно собираемых данных; носимые устройства для контроля правильности проведения лечения; системы позиционирования персонала и переносного оборудования; контроль и автоматическое пополнение запасов медикаментов в аптеках и ЛПУ;}
\todo{сельское хозяйство и животноводство: динамический мониторинг и оптимизация полного цикла сельскохозяйственных работ, на основе полученных данных с учетом свойств используемого сорта / биологического материала, почвы, агрохимикатов, истории погоды и т.п.; оптимизация эксплуатации теплиц и ферм за счет мониторинга и обработки данных; мониторинг сельскохозяйственной техники и оптимизация её работы; управление параметрами хранения и транспортировки сырья;}
\todo{транспортировка и хранение грузов: отслеживание транспортного парка – контроль перемещений и режима движения, повышение утилизации транспорта и дисциплины водителей, адаптация обслуживания к условиям эксплуатации; отслеживание товаров – контроль местоположения и перемещения товаров, мгновенная инвентаризация, отслеживание ключевых параметров при транспортировке и хранении на протяжении всей цепочки поставки; автоматизация складов – роботы грузчики и автоматические складские системы; автоматическое ранжирование по важности сигналов систем железнодорожной автоматики и телемеханики с целью оперативного реагирования на возможные поломки;}
\todo{городская инфраструктура: автоматическое отслеживание и оптимизация дорожного движения, в особенности городского транспорта; мониторинг и оптимизация работы жилищно-коммунального хозяйства, в том числе освещения улиц и объектов, вывоза и утилизации мусора, работы водопровода и электросетей; экомониторинг и мониторинг общественной безопасности, поддержка работы экстренных служб; контроль нагрузки и износа транспортной инфраструктуры (мостов, тоннелей и т.п.); мониторинг строительства; создание инфраструктуры для городского транспорта, в том числе электротранспорта и беспилотного транспорта; мониторинг и оптимизация работы спортивных объектов;}
\todo{инфраструктура зданий и сооружений: информационное обеспечение систем безопасности (датчики движения, состояние окон и дверей, видеонаблюдение, системы позиционирования людей); контроль инфраструктуры водопровода и электроснабжения зданий; управление микроклиматом в здании и энергосбережение в здании; мониторинг и управление подключенными приборами и устройствами;
подключенные и беспилотные автомобили: ассистенты водителя и автопилот движения по трассе; системы экстренного реагирования при авариях; автоматизация или частичная автоматизация средств общественного транспорта и диспетчерских с динамическим составлением расписаний для снижения рисков аварий на дорогах и повышения эффективности пассажиропотока с помощью адаптивного планирования на основе полученных данных;}
\todo{нефтегазодобыча: сбор данных со сложных распределенных объектов и обеспечение предсказательного обслуживания сложного оборудования, работающего в тяжелых условиях и труднодоступных районах на основе полученной информации; отслеживание состояния транспортной инфраструктуры и оптимизация ее обслуживания;}
\todo{обрабатывающая промышленность и машиностроение: сбор телеметрической информации в реальном режиме времени по беспроводным каналам связи; технологии поддержки принятия решений для ситуационного управления сложными техническими системами, дискретным и непрерывным производством на основе предиктивного моделирования по телеметрической информации и/или видеоданным в режиме реального времени;}
\todo{розничная торговля: электронные ценники; управление параметрами транспортировки и хранения товаров; новые способы заказа и оплаты товаров; автоматический анализ потоков и классификация клиентов; автоматический аудит ценников и товаров на полке, в том числе автоматическое наполнение полок; связь между контекстной онлайн рекламой и оффлайн покупками; интеллектуальные вендинговые автоматы;}
\todo{лесное хозяйство: детектирование аномалий и прогнозировании рисков возникновения пожаров в лесных массивах с учетом погодных условий и измеряемых параметров (температура, влажность, атмосферное давление, содержание газов и т.п.), а также статистических данных о природных пожарах; маркировка древесины на стадии роста и отслеживание ее на всем протяжении цепочки заготовки и поставки.}
\end{subsection}%{Анализ состояния индустрии}

\subsection{Медицина}
Использование машинного обучения в медицине \todo{(написать)}: \cite{shipp2002diffuse} \cite{ye2003predicting}

\subsection{Оптимизация бизнес процессов} \label{sect1_2_1}
Попытаюсь скопировать информацию о литературе и сослаться на нее.

There has recently been some interest in applying machine learning techniques to support the acquisition and adaptation of workflow models. The different learning algorithms, that have been proposed, share some restrictions, which may prevent them from being used in practice. Approaches applying techniques from grammatical inference are restricted to sequential workflows. Other algorithms allowing concurrency require unique activity nodes. This contribution shows how the basic principle of our previous approach to sequential workflow induction can be generalized, so that it is able to deal with concurrency. It does not require unique activity nodes. The presented approach uses a log-likelihood guided search in the space of workflow models, that starts with a most general workflow model containing unique activity nodes. Two split operators are available for specialization. \cite{Herbst2000}

\section{Машинное обучение в задачах управления инфраструктурой}

\subsection{Методы машинного обучения с подкреплением}

Рассмотрим марковский процесс первого порядка с дискретным временем, в котором  вероятность перехода из состояния $x$ в состояние $x'$ под действием $u$ задается как $p_0(x'|x,u)$.  Далее будем рассматривать эволюцию системы на бесконечном горизонте времени, с дисконтированием целевой функции со временем. Введем функцию вознаграждения, зависящую от текущего состояния и применяемого действия  как $R(x,u)$ и политику $\pi(u|x)$, определяющую вероятность применения действия в зависимости от текущего состояния $x$.

Предполагая, что политика $\pi$ и начальное состояние системы $x_0$ заданы, вероятность найти систему в состоянии $x_t$ на момент времени $t > 0$ задается следующим выражением:

\begin{equation}
    \label{eq:pxxt}
     p_\pi(x_t|x_0; t) =
     \sum_{u_{0:t−1}, x_{1:t−1}}{
     	\prod_{s=0}^{t-1} {
        	p_0(x_{s+1}|x_s, u_x) \pi(u_s|x_s)
         }
      }
\end{equation}

Таким образом ожидаемое дисконтированное вознаграждение в состоянии $x$, при следовании политике $\pi$ задается следующим выражением:

\begin{equation}
    \label{eq:j_pi}
     J_{\pi}(x) =
     \sum_{s=0}^{\infty}
       \sum_{u', x'}{
          \pi(u'|x')p_\pi(x'|x; s)R(x', u')\gamma^s
        }
\end{equation}
, где $\gamma$ - коэффициент дисконтирования ($0 < \gamma < 1$) и $p_pi(x'|x, 0) = \delta_{x,x'}$. Функция $J_\pi(x)$ называется функцией полезности и определяет ожидаемые выигрыш (вознаграждение) при следовании политике $\pi$. Цель обучения с подкреплением заключается в поиске политики $\pi$, максимизирующей значение $J_\pi(x)$ для всех значений $x$.

Выражение для $J_\pi(x)$ можно переписать в рекурсивном виде:
\begin{equation}
    \label{eq:j_pi_rec}
    \begin{split}
     J_\pi(x) &=
     \sum_u {\pi(u|x)R(x,u)} +
     \sum_{s=1}^{\infty}
       \sum_{u', x'}{
          \pi(u'|x')p_\pi(x'|x; s)R(x', u')\gamma^s
        } \\
        &= \sum_u {\pi(u|x)} \left(
        R(x,u) + \gamma \sum_{x'}{
        		p_0(x'|x; u)J_{\pi}(x')
            }
       		\right)
            \end{split}
\end{equation}

Процесс нахождения $J_\pi(x)$ методом последовательных приближений (см. подробнее~\cite{sutton1998reinforcement}) называется оценкой политики (англ. policy evaluation). После нахождения некоторой оценки  $J_\pi(x)$ мы можем предложить новую политику $\pi'$:

\begin{equation}
    \label{eq:new_policy}
    \begin{split}
    & \pi'(u|x) = \delta_{u,u(x)}, \\
    & u(x) = \argmax_u R(x, u) + \gamma \sum_{x'} p_0(x'|x, u)J_\pi(x')
    \end{split}
\end{equation}

Очевидно, что для новой политики $\pi'$ , будет выполняется выражение $J_{\pi'}(x) \geq J_\pi(x), \forall x$. Может быть показано, что итеративный процедура $$\pi_0 \rightarrow J_{\pi_0} \rightarrow \pi_1 \rightarrow J_{\pi_1} \rightarrow \pi_2 \rightarrow ... \rightarrow J^*$$ сходится  к оптимальному значению $J^*$.

Отметим, что в рассуждениях выше предполагается, что функции $p_0(x'|x,u)$, $R(x,u)$ заранее известны. Перейдем к ситуации, когда это окружение заранее не задано. В этом случае возможно либо выучить эти функции в процессе исследования и перейти к итеративной процедуре поиска оптимальной политики, либо использовать подходы обучения с подкреплением, не предполагающие априорное наличие модели ($p_0(x'|x,u)$, $R(x,u)$) - TD-Lambda \cite{sutton1998reinforcement} или Q-learning~\cite{Watkins:1989}.

В случае, когда $p_0(x'|x,u)$, $R(x,u)$ не известны, оценку дисконтированного вознаграждения для состояния $x$ ($J_\pi(x)$, см. уравнение (\ref{eq:j_pi})) можно получить при помощи сэмплирования:

\begin{equation}
    \label{eq:j_sampling}
   	J_\pi(x) = (1-\alpha)J_\pi(x) + \alpha(r + \gamma J_\pi(x')).
\end{equation}
, где $x$ - текущее состояние, $x'$ - новое состояние после выбора действия $u$ при следовании политике $\pi(u|x)$ и $r$ - наблюдаемая награда.

Уравнение~(\ref{eq:j_sampling}) соответствует ~\cite{sutton1998reinforcement} алгоритму TD(0). Отметим, что, применяя этот подход, перед выбором новой стратегии $\pi'$ требуется дождаться схождения алгоритма. Если же на каждой итерации менять политику $\pi'$ согласно уравнению (\ref{eq:new_policy}), получается другой подход, известный под названием Actor-Critic (см.~\cite{actor_critic}).

Более элегантный способ вычисления оптимальной политики без модели ($p_0(x'|x,u)$, $R(x,u)$) был предложен \cite{Watkins:1989} К. Ваткинсом. Обозначим как $Q(x, u)$ ожидаемое значение функции полезности состояния $x$ при выполнении действия $u$ и дальнейшем следовании оптимальной политике:

\begin{equation}
    \label{eq:q_learning_definition}
    \begin{split}
      & Q(x, u) = R(x, u) + \gamma \sum_{x'} {
          p_0(x'|x, u) \max_{u'} Q(x', u')
       }
       \\
      & J^{∗}(x) = \max_{u} Q(x,u)
     \end{split}
\end{equation}

В стохастическом окружении и при использовании онлайн-обучения уравнение (\ref{eq:q_learning_definition}) приобретает следующий вид:

\begin{equation}
    \label{eq:q_learning_online_stochastic}
    Q(x, u) = Q(x, u) + \alpha(R(x, u) + \gamma max_{u'} Q(x', u') − Q(x, u))
\end{equation},
где $\alpha$ - коэффициент, определяющий скорость обучения, $\gamma$ - коэффициент дисконтирования вознаграждений со временем. Далее мы будем придерживаться этих обозначений при формулировании задачи обучения с подкреплением.



\cite{лаптев2011применение, Magnusson:2012:SCW:2351316.2351327, hung2006applying, nelson2008exploiting, arisholm2007data, nguyen2012timely}
Reinforcement learning is the learning of a mapping from situations to actions so as to maximize a scalar reward or reinforcement signal. The learner is not told which action to take, as in most forms of machine learning, but instead must discover which actions yield the highest reward by trying them. In the most interesting and challenging cases, actions may affect not only the immediate's reward, but also the next situation, and through that all subsequent rewards. These two characteristics-trial-and-error search and delayed reward-are the two most important distinguishing features of reinforcement learning. \cite{book:963927, sutton1998introduction}



\subsection{Логические модели, леса решающих деревьев}
Tree boosting is a highly effective and widely used machine learning method. A scalable end-to-end tree boosting system called XGBoost is used widely by data scientists to achieve state-of-the-art results on many machine learning challenges. \cite{DBLP:journals/corr/ChenG16}

Логические модели широко используются \cite{бериков2008современные} для решения задач распознавания и прогнозирования. Это объясняется хорошей интерпретируемостью моделей, имеющих вид логических закономерностей, высокой прогнозирующей способностью, возможностью обрабатывать разнотипные переменные, выделять наиболее важные факторы. Логическую модель можно строить после группировки объектов некоторым алгоритмом, то есть решать задачу распознавания образов в классе логических решающих функций, где под образами понимаются номера кластеров, приписанные объектам. Существуют и алгоритмы, в которых группировка осуществляется непосредственно в ходе построения логической модели.

\todo{Написать своими словами введение}Machine learning: An artificial intelligence approach\cite{michalski2013machine}

Recently there has been a lot of interest in “ensemble learning” — methods that generate many classifiers and aggregate their results. Two well-known methods are boosting (see, e.g., Shapire et al., 1998) and bagging Breiman (1996) of classification trees. In boosting, successive trees give extra weight to points incorrectly predicted by earlier predictors. In the end, a weighted vote is taken for prediction. In bagging, successive trees do not depend on earlier trees — each is independently constructed using a bootstrap sample of the data set. In the end, a simple majority vote is taken for prediction. Breiman (2001) proposed random forests, which add an additional layer of randomness to bagging. In addition to constructing each tree using a different bootstrap sample of the data, random forests change how the classification or regression trees are constructed. In standard trees, each node is split using the best split among all variables. In a random forest, each node is split using the best among a subset of predictors randomly chosen at that node. This somewhat counterintuitive strategy turns out to perform very well compared to many other classifiers, including discriminant analysis, support vector machines and neural networks, and is robust against overfitting (Breiman, 2001). In addition, it is very user-friendly in the sense that it has only two parameters (the number of variables in the random subset at each node and the number of trees in the forest), and is usually not very sensitive to their values. \cite{liaw2002classification}

%\newpage
%============================================================================================================================

\section{Системы диагностирования технических устройств}
\cite{prishepa}
\begin{subsection}{Рынок WIoT}
\todo {Согласно исследованию компании PwC, технологии IoT являются лидерами среди прорывных технологий не только в плане влияния на бизнес-модели компаний и целых отраслей, но и также являются лидерами в плане инвестиционной привлекательности. Уже сейчас, по оценкам IDC, мировые расходы, связанные с использованием технологий IoT составляют около 800 млрд. долл. с прогнозом роста до 1,4 трлн. долл. к 2021 г. Крупнейшими секторами, которые инвестируют в IoT являются обрабатывающая промышленность, мониторинг грузов, управление производственными мощностями, интеллектуальные электросети. В ближайшие 5 лет ожидается быстрый рост расходов на IoT в области технологий «умного дома».}
\todo{На фоне быстрого роста расходов на IoT наблюдается также растущий интерес к данной области со стороны венчурных инвесторов. В США объем венчурных инвестиций в IoT вырос в 2,5 раза с 2013 г. К технологиям IoT проявляют интерес такие крупные компании-технологические лидеры как Intel, Cisco, GE, Qualcomm и др.}
\todo{Для российских компаний сейчас крайне важно не упустить свой шанс и занять свое место на рынке IoT технологий. В противном случае с этим рынком произойдет то же, что и с рынком мобильной радиосвязи, который в данный момент практически полностью отдан на откуп зарубежным производителям - на сегодняшний день российские компании практически не принимают участия в разработке и принятии международных стандартов, а также в разработке технических решений, что естественно приводит к фактическому отсутствию российских производителей оборудования и к практике тотальной покупки зарубежных технических решений. При этом даже на данный момент в России весьма развита сфера потребления телекоммуникационных и информационных услуг, и эта тенденция будет только усиливаться.}
\todo{Российский рынок IoT оценивается IDC примерно в 0,5\% от мирового рынка (около 4,25 млрд. долл. в 2017 г.) с прогнозом роста до 9 млрд. долл. к 2021 г. Ключевыми областями инвестиций в IoT в России, как и в мире, были транспорт, обрабатывающая промышленность, а также телекоммуникации и энергетика.}
\todo{По оценкам PwC экономический эффект от внедрения технологий IoT в России в 2018-2025 гг. составит более 2,7 трлн. руб. для таких направлений как электроэнергетика, здравоохранение, сельское хозяйство, логистика, городская среда, «умный дом».}
\todo{Достижение положительного мультипликативного эффекта в экономике от внедрения технологий IoT зависит от системности подхода к внедрению, в частности от совершенствования и развития регуляторной базы, развития механизмов поддержки IoT, создание условий для развития кадрового потенциала и продвижение российского опыта за рубежом. Мы уверены, что в случае продуманного и системного подхода IoT может стать одним из факторов роста экономики России в долгосрочной перспективе.}
\end{subsection}%{Рынок WIoT}}
\begin{subsection}{Вопросы безопасности}
\todo{Ускоряющийся темп роста рынка интернета вещей делает критичным вопрос обеспечения целостности и шифрования данных, безопасности устройств и защиты вовлеченных процессов от постороннего вмешательства. Сведения, которые хранятся в инфраструктуре интернета вещей имеют высокую коммерческую ценность, и часто являются стратегическими сведениями для страны. Сомнение в их безопасности является для индустрии наибольшей проблемой при внедрении новой технологии. Поэтому все описанные в данном проекте решения включают в себя элементы защиты информации. Важной составляющей является разработка стендов валидации протоколов и проработка архитектуры защиты целостности и конфиденциальности собираемых данных. Прежде всего в рамках работы центра будут разрабатываться методы т.н. «легкой криптографии», а также различных систем противодействия компрометации устройств.}
\todo{На данный момент мировому (и, естественно, российскому) рынку интернета вещей присуща большая степень фрагментарности - присутствует большое количество схожих, но несовместимых друг с другом решений. Важной составляющей развития описанной области является участие проектной команды в международных процессах выработки отраслевых стандартов и разработка национальных стандартов и рекомендаций по построению решений на основе интернета вещей. Участники проекта имеют большой опыт подобной деятельности в рамках работы комитетов 3GPP, IEEE, IETF, ETSI, а также в разработке отечественных стандартов и регламентов.}
\end{subsection}


% Сравнение
% https://www.quora.com/What-is-the-difference-between-Q-learning-TD-learning-and-TD-lambda/answer/Robby-Goetschalckx?srid=utslN

%\newpage
%============================================================================================================================

\section{Обсуждение}
